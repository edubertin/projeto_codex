<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>LangChain Hello</title>
    <style>
      :root {
        --bg: #0a0b0f;
        --panel: rgba(16, 18, 24, 0.72);
        --panel-strong: rgba(18, 20, 28, 0.94);
        --ink: #e8ecf4;
        --muted: #a2a8b7;
        --accent: #7ef0ff;
        --accent-2: #9a7bff;
        --border: rgba(255, 255, 255, 0.08);
        --glow: rgba(126, 240, 255, 0.35);
      }

      * { box-sizing: border-box; }

      body {
        margin: 0;
        font-family: "SF Pro Display", "Segoe UI", system-ui, sans-serif;
        color: var(--ink);
        background: radial-gradient(1200px 600px at 20% -10%, rgba(126, 240, 255, 0.12), transparent 60%),
                    radial-gradient(900px 500px at 90% 10%, rgba(154, 123, 255, 0.14), transparent 60%),
                    radial-gradient(800px 400px at 50% 120%, rgba(255, 255, 255, 0.08), transparent 60%),
                    var(--bg);
        min-height: 100vh;
        padding: 32px 20px 80px;
      }

      .chrome {
        position: fixed;
        inset: 0;
        pointer-events: none;
        background:
          linear-gradient(130deg, rgba(255,255,255,0.04) 0%, rgba(255,255,255,0) 30%),
          radial-gradient(1200px 600px at 15% 20%, rgba(126, 240, 255, 0.05), transparent 55%),
          radial-gradient(900px 600px at 85% 35%, rgba(154, 123, 255, 0.06), transparent 55%);
        mix-blend-mode: screen;
      }

      .container {
        max-width: 1100px;
        margin: 0 auto;
      }

      .header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 22px;
      }

      .brand {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .orb {
        width: 14px;
        height: 14px;
        border-radius: 50%;
        background: radial-gradient(circle at 30% 30%, var(--accent), var(--accent-2));
        box-shadow: 0 0 14px var(--glow);
      }

      .pill {
        display: inline-block;
        font-size: 12px;
        padding: 4px 10px;
        border-radius: 999px;
        border: 1px solid var(--border);
        color: var(--muted);
      }

      .hero {
        background: var(--panel);
        border: 1px solid var(--border);
        border-radius: 18px;
        padding: 26px;
        backdrop-filter: blur(18px);
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.55), inset 0 1px 0 rgba(255, 255, 255, 0.05);
        position: relative;
        overflow: hidden;
        margin-bottom: 24px;
      }

      .liquid {
        position: absolute;
        inset: -60% -20% auto;
        height: 260px;
        background: radial-gradient(60% 80% at 20% 20%, rgba(126,240,255,0.25), transparent 70%),
                    radial-gradient(60% 80% at 80% 80%, rgba(154,123,255,0.25), transparent 70%),
                    linear-gradient(120deg, rgba(255,255,255,0.06), rgba(255,255,255,0));
        filter: blur(26px);
        opacity: 0.7;
        animation: drift 10s ease-in-out infinite;
        pointer-events: none;
      }

      @keyframes drift {
        0%, 100% { transform: translateY(0) rotate(0deg); }
        50% { transform: translateY(12px) rotate(2deg); }
      }

      h1 {
        margin: 10px 0 6px;
        font-size: clamp(26px, 3vw, 36px);
        letter-spacing: 0.4px;
      }

      p { color: var(--muted); margin: 0; }

      .links {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
      }

      .links a {
        color: var(--ink);
        text-decoration: none;
        font-size: 14px;
        padding: 6px 10px;
        border-radius: 999px;
        border: 1px solid var(--border);
        background: rgba(255, 255, 255, 0.02);
      }

      .links a:hover {
        border-color: var(--accent);
        box-shadow: 0 0 10px rgba(126, 240, 255, 0.25);
      }

      .grid {
        display: grid;
        gap: 18px;
        grid-template-columns: 1fr;
      }

      @media (min-width: 900px) {
        .grid { grid-template-columns: 1.1fr 0.9fr; }
      }

      .card {
        background: var(--panel);
        border: 1px solid var(--border);
        border-radius: 16px;
        padding: 18px;
        backdrop-filter: blur(16px);
        box-shadow: 0 12px 30px rgba(0, 0, 0, 0.45);
      }

      .stack { display: grid; gap: 12px; }

      button {
        padding: 10px 16px;
        border: 1px solid rgba(255,255,255,0.12);
        border-radius: 10px;
        background: linear-gradient(135deg, rgba(126,240,255,0.15), rgba(154,123,255,0.18));
        color: var(--ink);
        cursor: pointer;
        font-weight: 600;
        box-shadow: 0 8px 20px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.08);
        width: fit-content;
      }

      button:hover { box-shadow: 0 0 18px var(--glow); }

      textarea, input {
        width: 100%;
        padding: 10px;
        border-radius: 10px;
        border: 1px solid var(--border);
        background: var(--panel-strong);
        color: var(--ink);
        box-shadow: inset 0 1px 2px rgba(0,0,0,0.4);
      }

      pre {
        white-space: pre-wrap;
        background: rgba(6, 7, 10, 0.8);
        padding: 12px;
        border-radius: 10px;
        border: 1px solid var(--border);
        color: #cfe5ff;
        min-height: 120px;
      }

      .section-title {
        margin: 0 0 8px;
        font-size: 16px;
        letter-spacing: 0.3px;
      }

      .muted { color: var(--muted); font-size: 14px; }

      .row { display: flex; gap: 12px; align-items: center; flex-wrap: wrap; }

      .hero-content {
        position: relative;
        z-index: 1;
      }
    </style>
  </head>
  <body>
    <div class="chrome"></div>
    <div class="container">
      <header class="header">
        <div class="brand">
          <span class="orb"></span>
          <strong>Starter RAG</strong>
        </div>
        <span class="pill">Postgres + pgvector</span>
      </header>

      <section class="hero">
        <div class="liquid"></div>
        <div class="hero-content">
          <h1>NodoOne Starter Pack</h1>
          <p>Um painel moderno para validar LLM e RAG com um fluxo simples e visual.</p>
          <div class="row" style="margin-top: 10px;">
            <div class="links">
              <a href="/docs" target="_blank" rel="noreferrer">Swagger</a>
              <a href="/redoc" target="_blank" rel="noreferrer">ReDoc</a>
              <a href="/openapi.json" target="_blank" rel="noreferrer">OpenAPI JSON</a>
            </div>
            <button id="btn">Chamar /api/hello</button>
          </div>
        </div>
      </section>

      <section class="grid">
        <div class="card stack">
          <h2 class="section-title">RAG - Ingestao</h2>
          <p class="muted">Adicione textos (um por linha) no banco vetorial.</p>
          <textarea id="ingestText" rows="6" placeholder="Ex:\nLangChain e uma biblioteca para apps com LLMs.\nO Postgres com pgvector armazena embeddings."></textarea>
          <button id="btnIngest">Enviar para /v1/ingest</button>
          <pre id="ingestOut">(sem ingestao)</pre>
        </div>

        <div class="card stack">
          <h2 class="section-title">RAG - Consulta</h2>
          <p class="muted">Teste a busca semantica com seus textos.</p>
          <label for="queryText">Pergunta</label>
          <input id="queryText" placeholder="Ex: O que e pgvector?" />
          <label for="queryK">Top K</label>
          <input id="queryK" type="number" min="1" max="10" value="4" />
          <button id="btnQuery">Enviar para /v1/query</button>
          <pre id="queryOut">(sem consulta)</pre>
        </div>
      </section>

      <section class="card" style="margin-top: 18px;">
        <h2 class="section-title">Resposta do LLM</h2>
        <pre id="output">(aguardando)</pre>
      </section>
    </div>

    <script>
      const btn = document.getElementById('btn');
      const output = document.getElementById('output');
      const btnIngest = document.getElementById('btnIngest');
      const ingestText = document.getElementById('ingestText');
      const ingestOut = document.getElementById('ingestOut');
      const btnQuery = document.getElementById('btnQuery');
      const queryText = document.getElementById('queryText');
      const queryK = document.getElementById('queryK');
      const queryOut = document.getElementById('queryOut');

      btn.addEventListener('click', async () => {
        output.textContent = 'carregando...';
        try {
          const res = await fetch('/api/hello');
          const data = await res.json();
          output.textContent = data.message || '(sem resposta)';
        } catch (err) {
          output.textContent = 'erro: ' + err;
        }
      });

      btnIngest.addEventListener('click', async () => {
        const lines = ingestText.value.split('\n').map(s => s.trim()).filter(Boolean);
        ingestOut.textContent = 'carregando...';
        try {
          const res = await fetch('/v1/ingest', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ texts: lines })
          });
          const data = await res.json();
          ingestOut.textContent = JSON.stringify(data, null, 2);
        } catch (err) {
          ingestOut.textContent = 'erro: ' + err;
        }
      });

      btnQuery.addEventListener('click', async () => {
        queryOut.textContent = 'carregando...';
        try {
          const res = await fetch('/v1/query', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ query: queryText.value, k: Number(queryK.value || 4) })
          });
          const data = await res.json();
          queryOut.textContent = JSON.stringify(data, null, 2);
        } catch (err) {
          queryOut.textContent = 'erro: ' + err;
        }
      });
    </script>
  </body>
</html>
